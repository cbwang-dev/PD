# P&D ISSP

## 1. Introduction

This is the project of P&D in Signal Processing track, KU Leuven. The general purpose of this project is to develop a hearing aid whose input is 1) EEG signal and 2) hearing aid microphone signal, so that it can steer the desired speech signal (indicated by EEG) in a cocktail party scenario.

- Audio processing: Given one source signal and one noise signal, along with a "rough" direction of the source signal (left hand side or right hand side), try to steer the linear mic array signal (or head mounted mic array signal) to minimize SIR.
  - Tech involved: narrowband/wideband [MUSIC](https://en.wikipedia.org/wiki/MUSIC_(algorithm)) algorithm, [DAS beamformer](http://www.labbookpages.co.uk/audio/beamforming/delaySum.html), GSC with VAD, FAS beamformer and frequency domain GSC.
- Deep learning: 

## 2. Project Structure

*Note: For saving GitHub space, somew of the files are not uploaded to GitHub. Check below for information of missing folders.*

### 2.1 Folders

- `0_Images/`: images for the project, used in the report. ~~`0_` prefix is for sorting convenience.~~
- `Audio_File/`: audio files for the phase 1 part of the project. Pre given.
- `computed_RIRs_phase_1/`: 2 scenarios of RIRs for the phase 1 "time-varying scenario" part of the project. `T60`, `DOA_source`, and `DOA_noise` are given in the name of each `.mat` file. Generated by information from `GUI_phase_1`.
- `data_phase_2/eeg_train/` and `data_phase_2/envelope_train`: EEG and audio data for the phase 2 part of the project. Pre given. 
- `data_phase_2/preprocessed_CNN/` and `data_phase_2/preprocessed_LR`: EEG and audio data for the phase 2 part of the project. Generated by script `main_preproc_phase_2.m`.
- `Documents/`: all (un)necessary PDF files of the project. Including compiled report.
- `func_metrics/`: functions for phase 1. Including VAD, GSC, FAS, MUSIC, and their time-varying variants.
- `func_preproc/`: preprocessing functions for phase 2. Including train and test dataset split.
- `GUI_phase_1/`: GUI setup for the phase 1 part of the project. Hand generated. Can be checked by command `mySA_GUI` and load your desired GUI setup.
- `Head_mounted_IRs/`: Head-mounted IRs for the phase 1 part of the project. Pre given.
- `jupyter_notebook/`: Jupyter notebook for the project.
- `markdown_notes/`: markdown notes for the project. Including report source file.
- `measured_IRs/`: result of `jupyter_notebook/PDISSP2022_measSession.ipynb` with the input `sweep_response`.
- `py_src/`: python source code for the phase 2 of the project.
- `sweep_response/`: measured Room Impulse Response (RIR) for the measurement session, phase 1 part of the project. Pre given.
- `test/`: test script for anything I am not sure about.

### 2.2 `.mat` Files

### 2.3 Scripts

## Start from Here

- *note 1: I use MacOS, and the folder navigation (slash or backslash) is different from Windows.*
- *note 2: Every time when you start at the root directory, run `runme` to register MATLAB path.*

### Phase 2

- Run `main_preproc_phase_2` twice, with variable `flag_LR_CNN` is set to `true` then `false`. This can take several hours. Before running this script, make sure:
  - original EEG data is stored in `./data_phase_2/eeg_train`. Regarding to non-disclosure aggrement, EEG files are not uploaded in this repository.
  - original envelope audio files are stored in `./data_phase_2/envelope_train`.
  - empty folders `./data_phase_2/preprocessed_CNN` and `./data_phase_2/preprocessed_LR` and its sub folders are created. The subfolder structure is identical to `./data_phase_2/eeg_train`.
- Linear Regression: Run `main_LR_phase_2`.
- CNN: First upload `./data_phase_2/preprocessed_CNN` and `./jupyter_notebook_phase_2/Experiment_$NUM$.ipynb` into Google Drive.

## Useful Commands (in root directory)

- Making report: `pandoc markdown_notes/report_phase1.md -o Documents/report_phase1.pdf`


## Question for TAs

- There are 3 directions. Left, Right, Front. Do we need to use HRTF in pre processing? 
- My problem in last year CNN was: model was correct, but the result was 50-50 random guess. I doubt that the pre processing is wrong. I need to double check this tomorrow.
- Is the delay kind of receptive field?
- for the concat of different trials, the detail.